<tr id="doc-{{ doc.id }}">
    <td class="px-6 py-4">
        <div class="flex items-center">
            <i data-lucide="file-text" class="w-5 h-5 text-copper-600 mr-3 flex-shrink-0"></i>
            <div>
                <div class="text-sm font-sans font-medium text-surface-900">{{ doc.short_name or doc.filename }}</div>
                <div class="text-xs font-sans text-surface-500">{{ doc.filename }} &middot; {{ (doc.size / 1024) | round(1) }} KB</div>
                {% if doc.employer_name or doc.union_local %}
                <div class="text-xs font-sans text-surface-400 mt-0.5">
                    {% if doc.employer_name %}{{ doc.employer_name }}{% endif %}
                    {% if doc.employer_name and doc.union_local %} / {% endif %}
                    {% if doc.union_local %}{{ doc.union_local }}{% endif %}
                </div>
                {% endif %}
            </div>
        </div>
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        {% if doc.status == 'indexed' %}
        <span class="px-2 py-0.5 text-xs font-medium rounded-full bg-green-50 text-green-700 border border-green-200">
            Indexed
        </span>
        {% elif doc.status == 'pending' %}
        <span class="px-2 py-0.5 text-xs font-medium rounded-full bg-amber-50 text-amber-700 border border-amber-200">
            Pending
        </span>
        {% elif doc.status == 'indexing' %}
        <span class="px-2 py-0.5 text-xs font-medium rounded-full bg-blue-50 text-blue-700 border border-blue-200">
            Indexing...
        </span>
        {% elif doc.status == 'error' %}
        <span class="px-2 py-0.5 text-xs font-medium rounded-full bg-red-50 text-red-700 border border-red-200"
              title="{{ doc.last_error }}">
            Error
        </span>
        {% endif %}
    </td>
    <td class="px-6 py-4 whitespace-nowrap">
        <button hx-post="/documents/{{ doc.id }}/toggle-public"
                hx-target="#doc-{{ doc.id }}"
                hx-swap="outerHTML"
                class="inline-flex items-center space-x-1 cursor-pointer group"
                title="Click to toggle public access">
            {% if doc.public_read %}
            <span class="px-2 py-0.5 text-xs font-medium rounded-full bg-blue-50 text-blue-700 border border-blue-200 group-hover:bg-blue-100 transition-colors inline-flex items-center">
                <i data-lucide="globe" class="w-3 h-3 mr-1"></i>
                Public
            </span>
            {% else %}
            <span class="px-2 py-0.5 text-xs font-medium rounded-full bg-surface-100 text-surface-600 border border-surface-200 group-hover:bg-surface-200 transition-colors inline-flex items-center">
                <i data-lucide="lock" class="w-3 h-3 mr-1"></i>
                Private
            </span>
            {% endif %}
        </button>
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm font-sans text-surface-500">
        {{ doc.pages or '-' }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm font-sans text-surface-500">
        {{ doc.extracted_at[:10] if doc.extracted_at else '-' }}
    </td>
    <td class="px-6 py-4 whitespace-nowrap text-sm font-sans space-x-2">
        {% if doc.status != 'indexed' %}
        <button hx-post="/documents/{{ doc.id }}/index"
                hx-target="#doc-{{ doc.id }}"
                hx-swap="outerHTML"
                hx-indicator="#index-spinner-{{ doc.id }}"
                class="text-copper-600 hover:text-copper-600/80 font-medium transition-colors">
            Index
            <span id="index-spinner-{{ doc.id }}" class="htmx-indicator">
                <i data-lucide="loader-2" class="w-4 h-4 inline animate-spin"></i>
            </span>
        </button>
        {% endif %}
        {% if doc.status == 'indexed' %}
        <a href="/documents/{{ doc.id }}/view" class="text-copper-600 hover:text-copper-600/80 font-medium transition-colors">View</a>
        {% endif %}
        <button onclick="toggleMetadata({{ doc.id }})" class="text-surface-400 hover:text-surface-600 ml-1 transition-colors" title="Edit metadata">
            <i data-lucide="pencil" class="w-4 h-4 inline"></i>
        </button>
    </td>
</tr>
<!-- Metadata edit row (hidden by default) -->
<tr id="meta-{{ doc.id }}" class="hidden bg-surface-50">
    <td colspan="6" class="px-6 py-3">
        <form hx-post="/documents/{{ doc.id }}/metadata"
              hx-target="#doc-{{ doc.id }}"
              hx-swap="outerHTML"
              class="grid grid-cols-3 gap-3 text-sm font-sans">
            <div>
                <label class="block text-xs font-medium text-surface-500">Short Name</label>
                <input type="text" name="short_name" value="{{ doc.short_name or '' }}"
                       class="mt-1 block w-full rounded-md border border-surface-200 bg-surface-0 text-sm px-2 py-1 focus:border-copper-600 focus:ring-1 focus:ring-copper-600"
                       placeholder="e.g. Spruce Grove">
            </div>
            <div>
                <label class="block text-xs font-medium text-surface-500">Employer</label>
                <input type="text" name="employer_name" value="{{ doc.employer_name or '' }}"
                       class="mt-1 block w-full rounded-md border border-surface-200 bg-surface-0 text-sm px-2 py-1 focus:border-copper-600 focus:ring-1 focus:ring-copper-600"
                       placeholder="City of Spruce Grove">
            </div>
            <div>
                <label class="block text-xs font-medium text-surface-500">Union Local</label>
                <input type="text" name="union_local" value="{{ doc.union_local or '' }}"
                       class="mt-1 block w-full rounded-md border border-surface-200 bg-surface-0 text-sm px-2 py-1 focus:border-copper-600 focus:ring-1 focus:ring-copper-600"
                       placeholder="CUPE Local 1234">
            </div>
            <div>
                <label class="block text-xs font-medium text-surface-500">Effective Date</label>
                <input type="text" name="effective_date" value="{{ doc.effective_date or '' }}"
                       class="mt-1 block w-full rounded-md border border-surface-200 bg-surface-0 text-sm px-2 py-1 focus:border-copper-600 focus:ring-1 focus:ring-copper-600"
                       placeholder="2023-01-01">
            </div>
            <div>
                <label class="block text-xs font-medium text-surface-500">Expiry Date</label>
                <input type="text" name="expiry_date" value="{{ doc.expiry_date or '' }}"
                       class="mt-1 block w-full rounded-md border border-surface-200 bg-surface-0 text-sm px-2 py-1 focus:border-copper-600 focus:ring-1 focus:ring-copper-600"
                       placeholder="2025-12-31">
            </div>
            <div>
                <label class="block text-xs font-medium text-surface-500">Region</label>
                <input type="text" name="region" value="{{ doc.region or '' }}"
                       class="mt-1 block w-full rounded-md border border-surface-200 bg-surface-0 text-sm px-2 py-1 focus:border-copper-600 focus:ring-1 focus:ring-copper-600"
                       placeholder="Alberta">
            </div>
            <div class="col-span-3 flex justify-end space-x-2 mt-1">
                <button type="button" onclick="toggleMetadata({{ doc.id }})"
                        class="px-3 py-1 text-xs font-sans text-surface-600 bg-surface-200 rounded-md hover:bg-surface-300 transition-colors">Cancel</button>
                <button type="submit"
                        class="px-3 py-1 text-xs font-sans text-surface-0 bg-copper-600 rounded-md hover:bg-copper-600/90 transition-colors">Save</button>
            </div>
        </form>
    </td>
</tr>
<script>
function toggleMetadata(id) {
    const row = document.getElementById('meta-' + id);
    if (row) row.classList.toggle('hidden');
}
</script>