{% extends "layout.html" %}

{% block content %}
<div class="space-y-6">

    <!-- Breadcrumb & Header -->
    <div class="border-b border-surface-200 pb-6">
        <nav class="mb-3" aria-label="Breadcrumb">
            <ol class="flex items-center gap-2 font-sans text-sm">
                <li>
                    <a href="/documents" class="text-surface-400 hover:text-copper-600 transition-colors">Documents</a>
                </li>
                <li>
                    <i data-lucide="chevron-right" class="w-3 h-3 text-surface-300"></i>
                </li>
                <li class="text-surface-700 font-medium">{{ document.filename }}</li>
            </ol>
        </nav>
        <h1 class="font-serif text-3xl text-surface-900">{{ document.filename }}</h1>
        <p class="mt-2 font-sans text-surface-500 text-sm">{{ document.pages }} pages &middot; Indexed: {{ document.extracted_at[:10] if document.extracted_at else 'N/A' }}</p>
    </div>

    <!-- Page Navigation -->
    <div class="bg-surface-0 border border-surface-200 rounded-lg p-4">
        <div class="flex items-center justify-between flex-wrap gap-4">
            <span class="font-sans text-sm font-medium text-surface-500">Jump to page:</span>
            <div class="flex flex-wrap gap-1.5">
                {% for i in range(1, document.pages + 1) %}
                <a href="/documents/{{ document.id }}/view?page={{ i }}"
                   class="px-3 py-1.5 font-sans text-sm font-medium rounded-lg transition-colors {% if current_page == i %}bg-copper-600 text-white{% else %}bg-surface-100 text-surface-600 hover:bg-surface-200 border border-surface-200{% endif %}">
                    {{ i }}
                </a>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Page Content -->
    <div class="bg-surface-0 border border-surface-200 rounded-lg overflow-hidden">
        {% for page in pages %}
        <div id="page-{{ page.page_number }}" class="p-6 {% if not loop.last %}border-b border-surface-200{% endif %}">
            <div class="flex items-center justify-between mb-4">
                <h2 class="font-serif text-lg text-surface-800 flex items-center gap-2">
                    <i data-lucide="file-text" class="w-5 h-5 text-copper-600"></i>
                    Page {{ page.page_number }}
                </h2>
                <span class="font-sans text-xs text-surface-400 bg-surface-50 px-2 py-1 rounded border border-surface-100">{{ page.text | length }} characters</span>
            </div>

            <div class="prose max-w-none">
                <pre class="whitespace-pre-wrap font-sans text-sm text-surface-700 bg-surface-50 p-4 rounded-lg overflow-x-auto border border-surface-100 leading-relaxed">{% if highlight %}{{ page.text | highlight_text(highlight) }}{% else %}{{ page.text }}{% endif %}</pre>
            </div>
            {% if highlight %}
            <div class="mt-3 flex items-center gap-2 font-sans text-xs text-surface-400">
                <i data-lucide="info" class="w-3 h-3 text-copper-400"></i>
                Highlighting: "<strong class="text-surface-600">{{ highlight }}</strong>"
            </div>
            {% endif %}
        </div>
        {% endfor %}
    </div>

    <!-- Previous / Next Navigation -->
    <div class="flex justify-between items-center">
        {% if current_page > 1 %}
        <a href="/documents/{{ document.id }}/view?page={{ current_page - 1 }}"
           class="inline-flex items-center px-5 py-2.5 border border-surface-300 font-sans text-sm font-medium rounded-lg text-surface-700 bg-surface-0 hover:bg-surface-50 hover:border-surface-400 transition-colors">
            <i data-lucide="chevron-left" class="w-4 h-4 mr-2"></i>
            Previous Page
        </a>
        {% else %}
        <span></span>
        {% endif %}

        {% if current_page < document.pages %}
        <a href="/documents/{{ document.id }}/view?page={{ current_page + 1 }}"
           class="inline-flex items-center px-5 py-2.5 bg-copper-600 hover:bg-copper-700 text-white font-sans text-sm font-medium rounded-lg transition-colors">
            Next Page
            <i data-lucide="chevron-right" class="w-4 h-4 ml-2"></i>
        </a>
        {% endif %}
    </div>

</div>
{% endblock %}
